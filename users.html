<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>× ×™×”×•×œ ××©×ª××©×™× - ××ª×¨ ××©×¤×—×ª×™</title>
  <link rel="stylesheet" href="admin.css">
  <style>
    main { padding: 2rem; }
    table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    th, td { padding: 12px 15px; text-align: right; border-bottom: 1px solid #ddd; }
    th { background: #4CAF50; color: white; }
    tr:hover { background: #f1f1f1; }
    button { padding: 6px 12px; margin: 0 2px; border-radius: 5px; border: none; cursor: pointer; transition: 0.3s; }
    .edit-btn { background: #ff9800; color: white; }
    .edit-btn:hover { background: #e68900; }
    .delete-btn { background: #f44336; color: white; }
    .delete-btn:hover { background: #d32f2f; }
    .back-btn { background: #4CAF50; color: white; margin-bottom: 15px; }
    .back-btn:hover { background: #45a049; }
  </style>
</head>
<body>

  <header>
    <h1>ğŸ‘¥ × ×™×”×•×œ ××©×ª××©×™×</h1>
    <button class="back-btn" onclick="goBack()">â¬… ×—×–×•×¨ ×œ×œ×•×— ×”× ×™×”×•×œ</button>
  </header>

  <main>
    <table id="usersTable">
      <thead>
        <tr>
          <th>×©× ××©×ª××©</th>
          <th>×ª×¤×§×™×“</th>
          <th>×¤×¢×•×œ×•×ª</th>
        </tr>
      </thead>
      <tbody>
        <!-- ×”××©×ª××©×™× ×™×ª×•×•×¡×¤×• ×›××Ÿ ×“×™× ××™×ª -->
      </tbody>
    </table>
  </main>

  <script>
    // ×‘×“×™×§×” ×× ×”××©×ª××© ××—×•×‘×¨ ×•×× ×”×œ
    const loggedUser = JSON.parse(sessionStorage.getItem('loggedUser'));
    if (!loggedUser || loggedUser.role !== 'admin') {
      alert('×’×™×©×” × ×“×—×ª×” â€“ ×“×£ ×–×” ××™×•×¢×“ ×¨×§ ×œ×× ×”×œ×™×');
      window.location.href = 'login.html';
    }

    // ×§×‘×œ×ª ×›×œ ×”××©×ª××©×™×
    function getUsers() {
      return JSON.parse(localStorage.getItem('users') || '{}');
    }

    function saveUsers(users) {
      localStorage.setItem('users', JSON.stringify(users));
    }

    // ×”×¦×’×ª ×”××©×ª××©×™× ×‘×˜×‘×œ×”
    function renderUsers() {
      const users = getUsers();
      const tbody = document.querySelector('#usersTable tbody');
      tbody.innerHTML = '';

      for (let username in users) {
        const role = users[username].role;
        const tr = document.createElement('tr');

        tr.innerHTML = `
          <td>${username}</td>
          <td>${role}</td>
          <td>
            <button class="edit-btn" onclick="editUser('${username}')">×¢×¨×•×š</button>
            <button class="delete-btn" onclick="deleteUser('${username}')">××—×§</button>
          </td>
        `;
        tbody.appendChild(tr);
      }
    }

    // ×¢×¨×™×›×ª ××©×ª××©
    function editUser(username) {
      const users = getUsers();
      const newPass = prompt(`×”×–×Ÿ ×¡×™×¡××” ×—×“×©×” ×¢×‘×•×¨ ${username}:`, users[username].password);
      if (newPass) {
        users[username].password = newPass;
        saveUsers(users);
        alert('×”×¡×™×¡××” ×¢×•×“×›× ×” ×‘×”×¦×œ×—×”!');
        renderUsers();
      }
    }

    // ××—×™×§×ª ××©×ª××©
    function deleteUser(username) {
      if (confirm(`×œ××—×•×§ ××ª ×”××©×ª××© ${username} ×œ×¦××™×ª×•×ª?`)) {
        const users = getUsers();
        delete users[username];
        saveUsers(users);
        renderUsers();
      }
    }

    function goBack() {
      window.location.href = 'admin.html';
    }

    // ×˜×¢×™× ×ª ×”××©×ª××©×™× ×›×©×”×“×£ × ×˜×¢×Ÿ
    document.addEventListener('DOMContentLoaded', renderUsers);
  </script>

</body>
</html>
